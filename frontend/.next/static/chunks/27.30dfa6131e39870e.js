"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[27],{1027:function(e,t,n){n.r(t),n.d(t,{default:function(){return u}});var s=n(7437),r=n(2265),a=n(9146),i=n(5810),o=n(1662),l=n(3876);let d=["function createContest(string trackURI, uint256 prizeAmount) returns (uint256)","function submitRemix(uint256 contestId, string remixURI, address payoutWallet) returns (uint256)","function vote(uint256 contestId, uint256 submissionId)","function endContestAndPay(uint256 contestId)","function getContest(uint256 contestId) view returns (uint256 id, address host, string trackURI, uint256 prizeAmount, bool active, uint256 createdAt, uint256 endedAt, uint256 winningSubmissionId)","function getSubmission(uint256 submissionId) view returns (uint256 id, uint256 contestId, address submitter, string remixURI, address payoutWallet, uint256 voteCount, uint256 createdAt)","function getContestSubmissions(uint256 contestId) view returns (uint256[])","function checkVoted(uint256 contestId, address voter) view returns (bool)","function contestCount() view returns (uint256)","event ContestCreated(uint256 indexed contestId, address indexed host, string trackURI, uint256 prizeAmount)","event RemixSubmitted(uint256 indexed submissionId, uint256 indexed contestId, address indexed submitter, string remixURI, address payoutWallet)","event VoteCast(uint256 indexed contestId, uint256 indexed submissionId, address indexed voter, uint256 newVoteCount)","event ContestEnded(uint256 indexed contestId, uint256 indexed winningSubmissionId, address indexed winner, uint256 prizeAmount)","event PrizePaid(uint256 indexed contestId, uint256 indexed submissionId, address indexed recipient, uint256 amount)"],c=["function approve(address spender, uint256 amount) returns (bool)","function allowance(address owner, address spender) view returns (uint256)","function balanceOf(address account) view returns (uint256)"];function u(){let[e,t]=(0,r.useState)(null),[n,u]=(0,r.useState)(null),[m,b]=(0,r.useState)(""),[x,g]=(0,r.useState)([]),[p,h]=(0,r.useState)(!1),[f,y]=(0,r.useState)(""),[w,v]=(0,r.useState)(""),[N,C]=(0,r.useState)(""),[j,I]=(0,r.useState)(""),[S,D]=(0,r.useState)(""),[A,k]=(0,r.useState)(""),[R,E]=(0,r.useState)(null),P="0xC0680334aA6b5B0aFc8253aE73900F3cC2e98B4D",U=parseInt("10143"),T=async()=>{try{if(!window.ethereum){y("❌ Please install MetaMask");return}let e=new a.Q(window.ethereum),n=await e.getNetwork();if(Number(n.chainId)!==U){y("❌ Please switch to Monad Testnet (Chain ID: ".concat(U,")"));return}let s=await window.ethereum.request({method:"eth_requestAccounts"}),r=await e.getSigner();t(e),u(r),b(s[0]),y("✅ Wallet connected!"),F(e),window.ethereum.on("accountsChanged",e=>{0===e.length?(b(""),u(null),y("❌ Wallet disconnected")):(b(e[0]),T())}),window.ethereum.on("chainChanged",()=>{window.location.reload()})}catch(e){console.error("Connection error:",e),y("❌ Connection failed: "+e.message)}},F=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e;if(t&&P)try{let e=new i.CH(P,d,t),n=await e.contestCount(),s=[];for(let t=1;t<=Number(n);t++){let n=await e.getContest(t),r=await e.getContestSubmissions(t),a=[];for(let t of r){let n=await e.getSubmission(Number(t));a.push({id:Number(n.id),contestId:Number(n.contestId),submitter:n.submitter,remixURI:n.remixURI,payoutWallet:n.payoutWallet,voteCount:Number(n.voteCount),createdAt:Number(n.createdAt)})}s.push({id:Number(n.id),host:n.host,trackURI:n.trackURI,prizeAmount:o.dF(n.prizeAmount),active:n.active,createdAt:Number(n.createdAt),endedAt:Number(n.endedAt),winningSubmissionId:Number(n.winningSubmissionId),submissions:a})}g(s)}catch(e){console.error("Load error:",e),y("❌ Error loading contests")}},z=async()=>{if(!n||!N||!j){y("❌ Please fill all fields");return}try{h(!0),y("⏳ Creating contest...");let e=o.fi(j),t=new i.CH("0x3d6aC5D3FFae950a03Ea6B14387895Ddc9E631A5",c,n);y("⏳ Approving tokens...");let s=await t.approve(P,e);await s.wait(),y("⏳ Creating contest...");let r=new i.CH(P,d,n),a=await r.createContest(N,e),l=await a.wait();v(l.hash),y("✅ Contest created! TX: ".concat(l.hash.slice(0,10),"...")),C(""),I(""),setTimeout(()=>F(),2e3)}catch(e){console.error("Create error:",e),y("❌ Error: "+e.message)}finally{h(!1)}},W=async e=>{if(!n||!S||!A){y("❌ Please fill all fields");return}if(!l.UJ(A)){y("❌ Invalid payout wallet address");return}try{h(!0),y("⏳ Submitting remix...");let t=new i.CH(P,d,n),s=await t.submitRemix(e,S,A),r=await s.wait();v(r.hash),y("✅ Remix submitted! TX: ".concat(r.hash.slice(0,10),"...")),D(""),k(""),E(null),setTimeout(()=>F(),2e3)}catch(e){console.error("Submit error:",e),y("❌ Error: "+e.message)}finally{h(!1)}},_=async(e,t)=>{if(!n){y("❌ Please connect wallet");return}try{h(!0),y("⏳ Preparing vote transaction...");let n=await new a.Q(window.ethereum).getSigner(),s=new i.CH(P,d,n);y("⏳ Sending vote transaction...");let r=await s.vote(e,t);y("⏳ Waiting for confirmation...");let o=await r.wait();v(o.hash),y("✅ Vote cast! TX: ".concat(o.hash.slice(0,10),"...")),setTimeout(()=>F(),2e3)}catch(e){console.error("Vote error:",e),"ACTION_REJECTED"===e.code?y("❌ Transaction rejected by user"):e.message.includes("Already voted")?y("❌ You have already voted in this contest"):e.message.includes("Block tracker destroyed")?y("❌ Connection lost. Please refresh and try again."):y("❌ Error: "+(e.reason||e.message))}finally{h(!1)}},B=async e=>{if(n&&window.confirm("Are you sure you want to end this contest and distribute the prize?"))try{h(!0),y("⏳ Preparing to end contest...");let t=await new a.Q(window.ethereum).getSigner(),n=new i.CH(P,d,t);y("⏳ Sending transaction to end contest...");let s=await n.endContestAndPay(e);y("⏳ Waiting for confirmation and prize payout...");let r=await s.wait();v(r.hash),y("✅ Contest ended! Prize paid! TX: ".concat(r.hash.slice(0,10),"...")),setTimeout(()=>F(),2e3)}catch(e){console.error("End contest error:",e),"ACTION_REJECTED"===e.code?y("❌ Transaction rejected by user"):e.message.includes("Block tracker destroyed")?y("❌ Connection lost. Please refresh and try again."):e.message.includes("Not active")?y("❌ Contest is not active"):e.message.includes("Only host")?y("❌ Only the contest host can end the contest"):y("❌ Error: "+(e.reason||e.message))}finally{h(!1)}};return(0,r.useEffect)(()=>{if(e){F();let e=setInterval(()=>F(),1e4);return()=>clearInterval(e)}},[e]),(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 text-white p-8",children:(0,s.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,s.jsxs)("div",{className:"text-center mb-12",children:[(0,s.jsxs)("div",{className:"flex items-center justify-center gap-4 mb-4",children:[(0,s.jsx)("img",{src:"/logo.png",alt:"SONAD",className:"h-16 w-16"}),(0,s.jsx)("h1",{className:"text-5xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent",children:"SONAD Remix Battles"})]}),(0,s.jsx)("p",{className:"text-gray-300",children:"Multiple submissions, community voting, winner takes prize!"}),!P&&(0,s.jsxs)("div",{className:"mt-4 p-4 bg-red-900/50 rounded-lg",children:[(0,s.jsx)("p",{className:"text-red-300",children:"⚠️ NEXT_PUBLIC_MULTI_REMIX_ADDRESS not configured!"}),(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"Add to .env.local: NEXT_PUBLIC_MULTI_REMIX_ADDRESS=0xC0680334aA6b5B0aFc8253aE73900F3cC2e98B4D"})]})]}),m?(0,s.jsx)("div",{className:"mb-8 p-4 bg-gray-800/50 rounded-lg",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("p",{className:"text-sm text-gray-400",children:["Connected: ",m.slice(0,6),"...",m.slice(-4)]}),(0,s.jsx)("button",{onClick:()=>F(),className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded text-sm font-bold",children:"\uD83D\uDD04 Refresh"})]})}):(0,s.jsx)("div",{className:"text-center mb-12",children:(0,s.jsx)("button",{onClick:T,className:"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 px-8 py-3 rounded-lg font-bold text-lg transition-all transform hover:scale-105",children:"Connect Wallet"})}),f&&(0,s.jsxs)("div",{className:"mb-6 p-4 rounded-lg ".concat(f.includes("❌")?"bg-red-900/50":f.includes("✅")?"bg-green-900/50":"bg-blue-900/50"),children:[(0,s.jsx)("p",{children:f}),w&&(0,s.jsxs)("a",{href:"https://testnet.monadexplorer.com/tx/".concat(w),target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 text-sm mt-2 inline-block",children:["View TX: ",w.slice(0,10),"...",w.slice(-8)," →"]})]}),m&&(0,s.jsxs)("div",{className:"mb-12 p-6 bg-gray-800/50 rounded-xl border border-purple-500/30",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"\uD83C\uDFAF Create New Contest"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("input",{type:"text",value:N,onChange:e=>C(e.target.value),placeholder:"Original Track URI (IPFS or URL)",className:"w-full p-3 bg-gray-700 rounded-lg border border-gray-600 focus:border-purple-500 outline-none"}),(0,s.jsx)("input",{type:"text",value:j,onChange:e=>I(e.target.value),placeholder:"Prize Amount (MON tokens)",className:"w-full p-3 bg-gray-700 rounded-lg border border-gray-600 focus:border-purple-500 outline-none"}),(0,s.jsx)("button",{onClick:z,disabled:p||!N||!j,className:"w-full bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 disabled:cursor-not-allowed px-6 py-3 rounded-lg font-bold transition-all",children:p?"⏳ Creating...":"\uD83C\uDFB5 Create Contest"})]})]}),(0,s.jsx)("div",{className:"space-y-8",children:x.map(e=>(0,s.jsxs)("div",{className:"bg-gray-800/50 rounded-xl border border-purple-500/30 p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h2",{className:"text-3xl font-bold mb-2",children:["Contest #",e.id]}),(0,s.jsxs)("p",{className:"text-gray-400 text-sm mb-1",children:["Host: ",e.host.slice(0,10),"...",e.host.slice(-8)]}),(0,s.jsxs)("p",{className:"text-gray-400 text-sm mb-1",children:["Original: ",e.trackURI]}),(0,s.jsxs)("p",{className:"text-purple-400 font-bold",children:["Prize: ",e.prizeAmount," MON"]})]}),(0,s.jsx)("div",{children:e.active?(0,s.jsx)("span",{className:"px-4 py-2 bg-green-600 rounded-full text-sm font-bold",children:"\uD83D\uDFE2 Active"}):(0,s.jsx)("span",{className:"px-4 py-2 bg-gray-600 rounded-full text-sm font-bold",children:"⚫ Ended"})})]}),e.active&&m&&(0,s.jsx)("div",{className:"mb-6 p-4 bg-gray-700/50 rounded-lg",children:R===e.id?(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("h3",{className:"font-bold text-lg",children:"Submit Your Remix"}),(0,s.jsx)("input",{type:"text",value:S,onChange:e=>D(e.target.value),placeholder:"Remix URI (IPFS or URL)",className:"w-full p-2 bg-gray-600 rounded border border-gray-500 focus:border-purple-500 outline-none"}),(0,s.jsx)("input",{type:"text",value:A,onChange:e=>k(e.target.value),placeholder:"Payout Wallet Address (0x...)",className:"w-full p-2 bg-gray-600 rounded border border-gray-500 focus:border-purple-500 outline-none"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>W(e.id),disabled:p,className:"flex-1 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 px-4 py-2 rounded font-bold",children:p?"⏳ Submitting...":"✅ Submit"}),(0,s.jsx)("button",{onClick:()=>E(null),className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 rounded",children:"Cancel"})]})]}):(0,s.jsx)("button",{onClick:()=>E(e.id),className:"w-full bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded font-bold",children:"+ Submit Remix"})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("h3",{className:"text-xl font-bold",children:["\uD83D\uDCDD Submissions (",e.submissions.length,")"]}),e.submissions.map(t=>(0,s.jsxs)("div",{className:"bg-gray-700/50 rounded-lg p-4 border border-gray-600",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("p",{className:"font-bold text-lg mb-1",children:["Remix #",t.id]}),(0,s.jsxs)("p",{className:"text-sm text-gray-400 mb-1",children:["URI: ",t.remixURI]}),(0,s.jsxs)("p",{className:"text-sm text-gray-400 mb-1",children:["Submitter: ",t.submitter.slice(0,10),"...",t.submitter.slice(-8)]}),(0,s.jsxs)("p",{className:"text-sm text-pink-400 font-bold",children:["\uD83D\uDCB0 Payout: ",t.payoutWallet.slice(0,10),"...",t.payoutWallet.slice(-8)]})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-3xl font-bold text-purple-400",children:t.voteCount}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"votes"})]})]}),e.active&&m&&(0,s.jsx)("button",{onClick:()=>_(e.id,t.id),disabled:p,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 px-4 py-2 rounded font-bold",children:"\uD83D\uDDF3️ Vote"}),!e.active&&e.winningSubmissionId===t.id&&(0,s.jsxs)("div",{className:"mt-2 p-2 bg-yellow-600/30 rounded text-center font-bold",children:["\uD83C\uDFC6 WINNER! Prize paid to ",t.payoutWallet.slice(0,10),"...",t.payoutWallet.slice(-8)]})]},t.id))]}),e.active&&m&&e.host.toLowerCase()===m.toLowerCase()&&(0,s.jsx)("div",{className:"mt-6",children:(0,s.jsx)("button",{onClick:()=>B(e.id),disabled:p||0===e.submissions.length,className:"w-full bg-red-600 hover:bg-red-700 disabled:bg-gray-600 disabled:cursor-not-allowed px-6 py-3 rounded-lg font-bold",children:p?"⏳ Processing...":"\uD83C\uDFC1 End Contest & Pay Prize"})})]},e.id))}),0===x.length&&m&&(0,s.jsx)("div",{className:"text-center text-gray-400 py-12",children:(0,s.jsx)("p",{className:"text-xl",children:"No contests yet. Create one to get started! \uD83C\uDFB5"})})]})})}}}]);