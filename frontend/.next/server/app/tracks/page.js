(()=>{var e={};e.id=999,e.ids=[999,331],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5315:e=>{"use strict";e.exports=require("path")},7360:e=>{"use strict";e.exports=require("url")},1342:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>x,pages:()=>c,routeModule:()=>m,tree:()=>d}),s(402),s(7764),s(5866);var a=s(3191),r=s(8716),l=s(7922),n=s.n(l),i=s(5231),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);s.d(t,o);let d=["",{children:["tracks",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,402)),"/home/yuvrajs/Desktop/MonadFInal/frontend/app/tracks/page.js"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,4998))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,7764)),"/home/yuvrajs/Desktop/MonadFInal/frontend/app/layout.js"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,4998))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/home/yuvrajs/Desktop/MonadFInal/frontend/app/tracks/page.js"],x="/tracks/page",p={require:s,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/tracks/page",pathname:"/tracks",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},2769:()=>{},6446:(e,t,s)=>{Promise.resolve().then(s.bind(s,9178))},5901:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2994,23)),Promise.resolve().then(s.t.bind(s,6114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,9671,23)),Promise.resolve().then(s.t.bind(s,1868,23)),Promise.resolve().then(s.t.bind(s,4759,23))},9178:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var a=s(326),r=s(7331);function l(){return a.jsx(r.default,{})}},7331:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var a=s(326),r=s(7577);function l({track:e,remixes:t=[],onOpenRemix:s,onVote:l}){let[n,i]=(0,r.useState)(!1),o=async()=>{try{(await fetch(`http://localhost:3002/api/tracks/${e.id}/vote`,{method:"PATCH"})).ok&&l&&l()}catch(e){console.error("Vote error",e)}};return(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start gap-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("h3",{className:"text-lg font-bold",children:e.title}),t.length>0&&(0,a.jsxs)("span",{className:"px-2 py-1 bg-purple-600 rounded-full text-xs",children:[t.length," remix",1!==t.length?"es":""]})]}),a.jsx("p",{className:"text-sm text-gray-400",children:e.description}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["Uploaded by: ",e.artist]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["Created: ",new Date(e.createdAt).toLocaleString()]})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end gap-2",children:[t.length>0&&a.jsx("button",{onClick:()=>i(e=>!e),className:"px-3 py-1 bg-primary rounded text-sm",children:n?"Hide Remixes":"Show Remixes"}),a.jsx("button",{onClick:s,className:"px-3 py-1 bg-secondary rounded text-sm",children:"Upload Remix"})]})]}),a.jsx("div",{className:"mt-4",children:a.jsx("audio",{controls:!0,src:e.fileUrl,className:"w-full"})}),(0,a.jsxs)("div",{className:"mt-3 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"text-sm text-primary font-bold",children:[e.voteCount||0," votes"]}),a.jsx("div",{className:"flex items-center gap-3",children:a.jsx("button",{onClick:o,className:"px-3 py-1 bg-green-600 rounded text-sm",children:"Vote"})})]}),n&&t.length>0&&(0,a.jsxs)("div",{className:"mt-4 border-t border-gray-700 pt-3",children:[(0,a.jsxs)("h4",{className:"font-bold text-purple-400 mb-3",children:["Remixes (",t.length,")"]}),t.map(e=>(0,a.jsxs)("div",{className:"mt-3 p-3 bg-gray-900 rounded border border-purple-500/30",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"font-semibold text-purple-300",children:["\uD83C\uDFB5 ",e.title]}),(0,a.jsxs)("div",{className:"text-xs text-gray-400",children:["by ",e.artist]}),a.jsx("div",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleString()})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end gap-1",children:[(0,a.jsxs)("div",{className:"text-sm text-primary font-bold",children:[e.voteCount||0," votes"]}),a.jsx("button",{onClick:async()=>{try{(await fetch(`http://localhost:3002/api/tracks/${e.id}/vote`,{method:"PATCH"})).ok&&l&&l()}catch(e){console.error("Vote error",e)}},className:"px-2 py-1 bg-green-600 rounded text-xs",children:"Vote"})]})]}),a.jsx("div",{className:"mt-2",children:a.jsx("audio",{controls:!0,src:e.fileUrl,className:"w-full"})})]},e.id))]})]})}function n({parentId:e,onClose:t,onSuccess:s}){let[l,n]=(0,r.useState)(""),[i,o]=(0,r.useState)(""),[d,c]=(0,r.useState)(null),[x,p]=(0,r.useState)(!1),[m,u]=(0,r.useState)(null),h=async t=>{if(t.preventDefault(),!d)return u("Please select a file");p(!0),u(null);try{let t=new FormData;t.append("file",d),t.append("title",l),t.append("description",i),t.append("parentId",e);let a=await fetch("http://localhost:3002/api/tracks",{method:"POST",body:t});if(!a.ok){let e=await a.text();throw Error(e||"Upload failed")}let r=await a.json();s&&s(r.track)}catch(e){console.error(e),u(e.message||"Upload error")}finally{p(!1)}};return a.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-gray-900 p-6 rounded-lg w-full max-w-lg",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-bold",children:"Upload Remix"}),a.jsx("button",{onClick:t,className:"text-gray-400",children:"Close"})]}),(0,a.jsxs)("form",{onSubmit:h,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm",children:"Title"}),a.jsx("input",{value:l,onChange:e=>n(e.target.value),className:"w-full px-3 py-2 bg-gray-800 rounded"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm",children:"Description"}),a.jsx("textarea",{value:i,onChange:e=>o(e.target.value),className:"w-full px-3 py-2 bg-gray-800 rounded",rows:3})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm",children:"MP4 / Audio File"}),a.jsx("input",{type:"file",accept:"video/mp4,audio/*",onChange:e=>{c(e.target.files[0])},className:"w-full"})]}),m&&a.jsx("div",{className:"text-red-400",children:m}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[a.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 bg-gray-700 rounded",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:x,className:"px-4 py-2 bg-primary rounded",children:x?"Uploading...":"Upload"})]})]})]})})}function i(){let[e,t]=(0,r.useState)([]),[s,i]=(0,r.useState)(!0),[o,d]=(0,r.useState)(null),[c,x]=(0,r.useState)(null);async function p(){i(!0),d(null);try{let e=await fetch("http://localhost:3002/api/tracks");if(!e.ok)throw Error("Failed to load tracks");let s=(await e.json()).tracks||[];s.sort((e,t)=>new Date(t.createdAt)-new Date(e.createdAt)),t(s)}catch(e){console.error("Error fetching tracks:",e),d("Unable to load tracks")}finally{i(!1)}}let m=e.filter(e=>!e.parentId);return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-6 flex justify-between items-center",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold",children:["Tracks (",m.length,") - Total: ",e.length]}),a.jsx("button",{onClick:p,disabled:s,className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 rounded font-bold",children:s?"⏳ Loading...":"\uD83D\uDD04 Refresh"})]}),o&&(0,a.jsxs)("div",{className:"bg-red-800/40 text-red-200 p-4 rounded mb-4",children:["Error loading tracks: ",o,a.jsx("button",{onClick:p,className:"ml-4 px-3 py-1 bg-red-600 hover:bg-red-700 rounded text-sm",children:"Retry"})]}),!s&&!o&&e.length>0&&0===m.length&&(0,a.jsxs)("div",{className:"bg-yellow-800/40 text-yellow-200 p-4 rounded mb-4",children:[(0,a.jsxs)("p",{className:"font-bold",children:["⚠️ ",e.length," tracks loaded but all are remixes (no parent tracks)"]}),a.jsx("p",{className:"text-sm mt-2",children:"All tracks have parentId set"})]}),!s&&!o&&0===e.length&&(0,a.jsxs)("div",{className:"text-center py-12 text-gray-400",children:[a.jsx("p",{className:"text-xl mb-2",children:"No tracks yet"}),a.jsx("p",{children:"Upload a track to get started!"})]}),!s&&!o&&m.length>0&&a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:m.map(t=>a.jsx(l,{track:t,remixes:e.filter(e=>e.parentId===t.id),onOpenRemix:()=>x(t.id),onVote:()=>p()},t.id))}),c&&a.jsx(n,{parentId:c,onClose:()=>x(null),onSuccess:e=>{p(),x(null)}})]})}!function(){var e=Error("Cannot find module './VoteButton'");throw e.code="MODULE_NOT_FOUND",e}()},7764:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l,metadata:()=>r});var a=s(9510);s(7272);let r={title:"SONAD - Sound on Monad",description:"Decentralized music platform and remix competitions on Monad blockchain"};function l({children:e}){return a.jsx("html",{lang:"en",suppressHydrationWarning:!0,children:a.jsx("body",{className:"bg-gray-900 text-white min-h-screen",suppressHydrationWarning:!0,children:e})})}},402:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(8570).createProxy)(String.raw`/home/yuvrajs/Desktop/MonadFInal/frontend/app/tracks/page.js#default`)},4998:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var a=s(6621);let r=e=>[{type:"image/png",sizes:"425x384",url:(0,a.fillMetadataSegment)(".",e.params,"icon.png")+"?12f76f7c76e4db05"}]},7272:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[948,471,621],()=>s(1342));module.exports=a})();