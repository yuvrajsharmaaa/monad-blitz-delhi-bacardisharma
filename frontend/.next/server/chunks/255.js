"use strict";exports.id=255,exports.ids=[255],exports.modules={8185:(e,s,t)=>{t.r(s),t.d(s,{default:()=>d});var a=t(326),r=t(7577),l=t(5320),i=t(1389),n=t(5846),o=t(6806);function d(){let{signer:e,provider:s,account:t}=(0,o.O)(),[d,c]=(0,r.useState)(null),[x,m]=(0,r.useState)(null),[u,b]=(0,r.useState)(""),[g,p]=(0,r.useState)(""),[h,N]=(0,r.useState)("0"),[y,j]=(0,r.useState)(!1),[f,v]=(0,r.useState)(!1),[D,w]=(0,r.useState)(!1),[C,S]=(0,r.useState)(""),[E,R]=(0,r.useState)(0),[k,T]=(0,r.useState)([]),[I,A]=(0,r.useState)(!1),[V,z]=(0,r.useState)(!1),[F,P]=(0,r.useState)(""),[$,O]=(0,r.useState)(""),[L,U]=(0,r.useState)(!1),B="0x7637801a09823b8AF38c0029DAe381EA4c31668b",H="0x3d6aC5D3FFae950a03Ea6B14387895Ddc9E631A5",M=["function approve(address spender, uint256 amount) returns (bool)","function allowance(address owner, address spender) view returns (uint256)","function balanceOf(address account) view returns (uint256)"];async function _(e){try{let[s,a,r,i,n,o,d]=await Promise.all([e.trackURI(),e.host(),e.prizeAmount(),e.votingActive(),e.prizeDistributed(),e.winner(),e.winningRemixId()]);if(b(s),p(a),N(l.dF(r)),v(i),w(n),S(o),R(Number(d)),t){j(t.toLowerCase()===a.toLowerCase());let s=await e.hasUserVoted(t);A(s)}await G(e)}catch(e){console.error("Load data error:",e),P(`Error loading data: ${e.message}`)}}async function G(e){try{let[s,t,a,r]=await e.getAllRemixes(),l=s.map((e,s)=>({id:Number(e),remixer:t[s],uri:a[s],votes:Number(r[s])}));l.sort((e,s)=>s.votes-e.votes),T(l)}catch(e){console.error("Load remixes error:",e)}}async function W(){if(d&&$){z(!0);try{P("\uD83D\uDCE4 Submitting remix...");let e=await d.submitRemix($);P("⏳ Transaction pending..."),await e.wait(),P("✅ Remix submitted successfully!"),O(""),U(!1),await G(x)}catch(e){console.error("Submit error:",e),P(`❌ Error: ${e.reason||e.message}`)}finally{z(!1)}}}async function Y(e){if(d){z(!0);try{P("\uD83D\uDDF3️ Casting vote...");let s=await d.vote(e);P("⏳ Transaction pending..."),await s.wait(),P("✅ Vote cast successfully!"),A(!0),await G(x)}catch(e){console.error("Vote error:",e),P(`❌ Error: ${e.reason||e.message}`)}finally{z(!1)}}}async function K(){if(d){if(H)try{let s=new i.CH(H,M,e),a=await s.allowance(t,B),r=l.fi(h);if(a<r){P("⚠️ Approving prize tokens...");let e=await s.approve(B,r);P("⏳ Approval pending..."),await e.wait(),P("✅ Tokens approved!")}}catch(e){console.error("Approval error:",e),P(`❌ Approval failed: ${e.message}`);return}z(!0);try{P("\uD83C\uDFC1 Ending voting and distributing prize...");let e=await d.endVoting();P("⏳ Transaction pending..."),await e.wait(),P("✅ Voting ended! Prize distributed to winner!"),await _(x)}catch(e){console.error("End voting error:",e),P(`❌ Error: ${e.reason||e.message}`)}finally{z(!1)}}}return(0,a.jsxs)("div",{className:"max-w-6xl mx-auto p-6",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-purple-900 to-indigo-900 rounded-lg p-6 mb-6",children:[a.jsx("h1",{className:"text-3xl font-bold mb-2",children:"\uD83C\uDFB5 Track Voting & Prize Distribution"}),a.jsx("p",{className:"text-gray-300",children:"Submit remixes, vote, and win prizes on Monad testnet"})]}),!B&&a.jsx("div",{className:"bg-red-900/50 border border-red-500 rounded-lg p-4 mb-6",children:(0,a.jsxs)("p",{className:"text-red-200",children:["⚠️ ",a.jsx("strong",{children:"TrackVoting contract not configured!"}),a.jsx("br",{}),"Please deploy the contract and add NEXT_PUBLIC_TRACK_VOTING_ADDRESS to .env.local"]})}),(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 mb-6",children:[a.jsx("h2",{className:"text-xl font-bold mb-4",children:"Track Details"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm text-gray-400",children:"Host"}),(0,a.jsxs)("p",{className:"font-mono text-sm",children:[g?`${g.slice(0,6)}...${g.slice(-4)}`:"Loading...",y&&a.jsx("span",{className:"ml-2 text-purple-400",children:"(You)"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm text-gray-400",children:"Prize"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-yellow-400",children:[h," MON"]})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"text-sm text-gray-400",children:"Track URI"}),a.jsx("p",{className:"font-mono text-xs break-all text-gray-300",children:u||"Loading..."})]})]}),(0,a.jsxs)("div",{className:"mt-4 flex gap-2",children:[f?a.jsx("span",{className:"px-3 py-1 bg-green-600 rounded-full text-sm font-bold",children:"\uD83D\uDFE2 VOTING ACTIVE"}):a.jsx("span",{className:"px-3 py-1 bg-red-600 rounded-full text-sm font-bold",children:"\uD83D\uDD34 VOTING ENDED"}),D&&a.jsx("span",{className:"px-3 py-1 bg-yellow-600 rounded-full text-sm font-bold",children:"\uD83D\uDCB0 PRIZE DISTRIBUTED"})]})]}),F&&a.jsx("div",{className:`mb-6 p-4 rounded-lg ${F.includes("❌")?"bg-red-900/40 text-red-200":F.includes("✅")?"bg-green-900/40 text-green-200":F.includes("⚠️")?"bg-yellow-900/40 text-yellow-200":"bg-blue-900/40 text-blue-200"}`,children:F}),!f&&C&&C!==n.N&&(0,a.jsxs)("div",{className:"bg-gradient-to-r from-yellow-900 to-orange-900 border-2 border-yellow-500 rounded-lg p-6 mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("span",{className:"text-4xl",children:"\uD83C\uDFC6"}),a.jsx("h2",{className:"text-2xl font-bold",children:"Winner!"})]}),(0,a.jsxs)("p",{className:"text-lg mb-2",children:["Remix #",E," by"," ",(0,a.jsxs)("span",{className:"font-mono font-bold",children:[C.slice(0,6),"...",C.slice(-4)]})]}),D&&(0,a.jsxs)("p",{className:"text-green-300",children:["✅ Prize of ",h," MON tokens distributed!"]})]}),(0,a.jsxs)("div",{className:"flex gap-3 mb-6",children:[f&&!y&&!I&&a.jsx("button",{onClick:()=>U(!L),className:"px-6 py-3 bg-purple-600 hover:bg-purple-700 rounded-lg font-bold transition",children:"\uD83D\uDCE4 Submit Remix"}),f&&y&&k.length>0&&a.jsx("button",{onClick:K,disabled:V,className:"px-6 py-3 bg-red-600 hover:bg-red-700 rounded-lg font-bold transition disabled:opacity-50",children:"\uD83C\uDFC1 End Voting & Distribute Prize"})]}),L&&f&&(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-bold mb-4",children:"Submit Your Remix"}),a.jsx("input",{type:"text",value:$,onChange:e=>O(e.target.value),placeholder:"Enter remix URI (ipfs:// or http://...)",className:"w-full px-4 py-3 bg-gray-900 rounded-lg mb-3"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:W,disabled:V||!$,className:"px-6 py-2 bg-purple-600 hover:bg-purple-700 rounded-lg font-bold transition disabled:opacity-50",children:"Submit"}),a.jsx("button",{onClick:()=>U(!1),className:"px-6 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg transition",children:"Cancel"})]})]}),(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold mb-4",children:["Remixes (",k.length,")"]}),0===k.length?a.jsx("p",{className:"text-gray-400 text-center py-8",children:"No remixes submitted yet. Be the first!"}):a.jsx("div",{className:"space-y-3",children:k.map((e,s)=>(0,a.jsxs)("div",{className:`p-4 rounded-lg border-2 ${e.id!==E||f?"border-gray-700 bg-gray-900":"border-yellow-500 bg-yellow-900/20"}`,children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[0===s&&a.jsx("span",{className:"text-2xl",children:"\uD83E\uDD47"}),1===s&&a.jsx("span",{className:"text-2xl",children:"\uD83E\uDD48"}),2===s&&a.jsx("span",{className:"text-2xl",children:"\uD83E\uDD49"}),(0,a.jsxs)("span",{className:"text-sm text-gray-400",children:["Remix #",e.id]}),e.id===E&&!f&&a.jsx("span",{className:"px-2 py-1 bg-yellow-600 rounded-full text-xs font-bold",children:"\uD83C\uDFC6 WINNER"})]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 font-mono mb-2",children:["by ",e.remixer.slice(0,6),"...",e.remixer.slice(-4)]}),a.jsx("p",{className:"text-xs text-gray-400 break-all",children:e.uri})]}),(0,a.jsxs)("div",{className:"text-right ml-4",children:[a.jsx("div",{className:"text-3xl font-bold text-purple-400",children:e.votes}),a.jsx("div",{className:"text-xs text-gray-400",children:"votes"})]})]}),f&&!I&&!y&&a.jsx("button",{onClick:()=>Y(e.id),disabled:V,className:"w-full px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg font-bold transition disabled:opacity-50",children:"\uD83D\uDDF3️ Vote for this Remix"}),I&&a.jsx("div",{className:"text-center text-sm text-gray-500 py-2",children:"✅ You have already voted"})]},e.id))})]}),(0,a.jsxs)("div",{className:"mt-6 bg-blue-900/30 border border-blue-500 rounded-lg p-4",children:[a.jsx("h3",{className:"font-bold mb-2",children:"ℹ️ How It Works"}),(0,a.jsxs)("ul",{className:"text-sm text-blue-200 space-y-1",children:[a.jsx("li",{children:"• Submit your remix URI to enter the competition"}),a.jsx("li",{children:"• Vote for your favorite remix (one vote per wallet)"}),a.jsx("li",{children:"• Host ends voting when ready"}),a.jsx("li",{children:"• Remix with most votes wins the prize automatically"}),a.jsx("li",{children:"• Prize MON tokens sent directly to winner"})]})]})]})}}};